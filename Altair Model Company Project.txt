select*from products;
select*from orderdetails;
select*from customers;
select*from payments;
select*from employees;
select*from offices;


General Select code

SELECT DISTINCT column_name, AGG_FUNC(column_or_expression), â€¦
FROM mytable
    JOIN another_table
      ON mytable.column = another_table.column
    WHERE constraint_expression
    GROUP BY column
    HAVING constraint_expression
    ORDER BY column ASC/DESC
    LIMIT count OFFSET COUNT;



// starts here //
/* i think we are missing subquery's throught the project. we gotta learn that*/

/*Sales topic:*/

SELECT year(o.orderdate), Month(o.orderdate), p.productLine, sum(od.quantityOrdered) as total_ordered
FROM orderdetails od 
    JOIN products p  
      ON od.productcode = p.productcode 
	JOIN orders o
      ON od.ordernumber = o.ordernumber
    GROUP BY year(o.orderdate), Month(o.orderdate), p.productLine 
    ORDER BY year(o.orderdate) asc, month(o.orderdate) asc, sum(od.quantityOrdered) DESC;
    
    
    not finished
    
    SELECT year(orderdate), Month(o.orderdate), p.productLine, sum(od.quantityOrdered),
LAG(sum(od.quantityOrdered)) over (order by year(orderdate), month(orderdate))
FROM orderdetails od 
    left JOIN products p  
      ON od.productcode = p.productcode 
	left JOIN orders o
      ON od.ordernumber = o.ordernumber
    GROUP BY year(o.orderdate), Month(o.orderdate), p.productLine
    ORDER BY year(o.orderdate) asc, month(o.orderdate) asc;
    
    
/*--this is another part of code which gives categories as columns
  
SELECT 
YEAR(o.orderDate) as Sales_Year,
MONTH(o.orderDate) as Sales_Month,
SUM(case when p.productLine = 'Motorcycles' then od.quantityOrdered else 0 end) AS Motorcycles_Sales,
SUM(case when p.productLine = 'Classic Cars' then od.quantityOrdered else 0 end) AS Classic_Cars_Sales,
SUM(case when p.productLine = 'Trucks and Buses' then od.quantityOrdered else 0 end) AS Trucks_Buses_Sales,
SUM(case when p.productLine = 'Vintage Cars' then od.quantityOrdered else 0 end) AS Vintage_Cars_Sales,
SUM(case when p.productLine = 'Planes' then od.quantityOrdered else 0 end) AS Planes_Sales,
SUM(case when p.productLine = 'Trains' then od.quantityOrdered else 0 end) AS Trains_Sales,
SUM(case when p.productLine = 'Ships' then od.quantityOrdered else 0 end) AS Ships_Sales
FROM orders o
join orderdetails od on o.orderNumber = od.orderNumber
join products p on p.productCode = od.productCode
WHERE YEAR(o.orderDate)='2021'
GROUP BY YEAR(o.orderDate), MONTH(o.orderDate)
ORDER BY YEAR(o.orderDate), MONTH(o.orderDate);
    
    
/*Financial Topic

-monthly turnover by country*/


SELECT sum(od.quantityordered) as order_turnover, c.country as customer_country
FROM customers c
	left Join orders o
		ON c.customerNumber = o.customernumber
	jOIN orderdetails od
		ON od.ordernumber = o.ordernumber
	GROUP BY c.country
	ORDER BY c.country, sum(od.quantityOrdered) DESC;
    
    /*missing the rest of the question*/
    
/*Logistics topic*/

SELECT p.productName, sum(od.quantityOrdered) as Total_ordered
FROM orderdetails od
    JOIN products p
      ON od.productcode = p.productcode
    GROUP BY p.productCode
    ORDER BY sum(od.quantityOrdered) DESC
    LIMIT 5;
    
    
/* top 5 ordered products, missing the rest */

/* human resources topic */


NEED TO CHANGE THE TURNOVER


SELECT monthname(p.paymentdate), concat(e.firstName, ' ', e.lastname) as full_employee_name, sum(p.amount) as turnover
FROM customers c
    JOIN payments p
		ON c.customernumber = p.customernumber
	Join employees e
		ON c.salesRepEmployeeNumber = e.employeeNumber
    GROUP BY monthname(p.paymentdate), c.salesRepEmployeeNumber
    ORDER BY monthname(p.paymentdate) Desc, sum(p.amount) desc
    limit 2;
   
