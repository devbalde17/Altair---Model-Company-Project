select*from products;
select*from orderdetails;
select*from customers;
select*from payments;
select*from employees;
select*from offices;


General Select code

SELECT DISTINCT column_name, AGG_FUNC(column_or_expression), â€¦
FROM mytable
    JOIN another_table
      ON mytable.column = another_table.column
    WHERE constraint_expression
    GROUP BY column
    HAVING constraint_expression
    ORDER BY column ASC/DESC
    LIMIT count OFFSET COUNT;



// starts here //
/* i think we are missing subquery's throught the project. we gotta learn that*/

/*Sales topic:*/

SELECT year(o.orderdate), Month(o.orderdate), p.productLine, sum(od.quantityOrdered) as total_ordered
FROM orderdetails od 
    JOIN products p  
      ON od.productcode = p.productcode 
	JOIN orders o
      ON od.ordernumber = o.ordernumber
    GROUP BY year(o.orderdate), Month(o.orderdate), p.productLine 
    ORDER BY year(o.orderdate) asc, month(o.orderdate) asc, sum(od.quantityOrdered) DESC;
    
    
/*Financial Topic

-monthly turnover by country*/


SELECT month(p.paymentdate), sum(p.amount) as turnover, c.country
FROM customers c
    JOIN payments p
		ON c.customernumber = p.customernumber
	Join employees e
		ON c.salesRepEmployeeNumber = e.employeeNumber
    GROUP BY month(p.paymentdate), c.country
    ORDER BY month(p.paymentdate), c.country asc;
    
    /*missing the rest of the question*/
    
/*Logistics topic*/

SELECT p.productName, sum(od.quantityOrdered) as Total_ordered
FROM orderdetails od
    JOIN products p
      ON od.productcode = p.productcode
    GROUP BY p.productCode
    ORDER BY sum(od.quantityOrdered) DESC
    LIMIT 5;
    
    
/* top 5 ordered products, missing the rest */

/* human resources topic */

SELECT monthname(p.paymentdate), concat(e.firstName, ' ', e.lastname) as full_employee_name, sum(p.amount) as turnover
FROM customers c
    JOIN payments p
		ON c.customernumber = p.customernumber
	Join employees e
		ON c.salesRepEmployeeNumber = e.employeeNumber
    GROUP BY monthname(p.paymentdate), c.salesRepEmployeeNumber
    ORDER BY monthname(p.paymentdate) Desc, sum(p.amount) desc
    limit 2;
   
